import{x as e,a1 as t,Y as n,h as o,w as a,bn as s,a6 as l,Q as r,e as i,E as c,bM as u,bN as d,f as p,r as m,X as f,bO as v,A as g,_ as h,J as b,o as y,l as C,m as E,L as x,K as w,B,s as M,n as k,M as T,j as I,p as L,N as R,C as S,ab as A,q as _,a8 as z,O as $,T as P,aN as j,g as O,bP as V,bQ as H,bt as D,a5 as K,bk as q,bJ as X,a$ as Y,bR as N}from"./index-f84eb1d7.js";import{E as U}from"./el-button-f55acee8.js";import{E as F}from"./index-e08c7343.js";import{o as J,E as Q,a as W,u as Z}from"./index-c3e7656c.js";import{E as G}from"./focus-trap-b355df7c.js";import{i as ee}from"./validator-045a886a.js";import{u as te}from"./index-01b4041d.js";const ne=(a,s,l)=>{let r={offsetX:0,offsetY:0};const i=e=>{const t=e.clientX,n=e.clientY,{offsetX:s,offsetY:l}=r,i=a.value.getBoundingClientRect(),c=i.left,u=i.top,d=i.width,p=i.height,m=document.documentElement.clientWidth,f=document.documentElement.clientHeight,v=-c+s,g=-u+l,h=m-c-d+s,b=f-u-p+l,y=e=>{const i=Math.min(Math.max(s+e.clientX-t,v),h),c=Math.min(Math.max(l+e.clientY-n,g),b);r={offsetX:i,offsetY:c},a.value.style.transform=`translate(${o(i)}, ${o(c)})`},C=()=>{document.removeEventListener("mousemove",y),document.removeEventListener("mouseup",C)};document.addEventListener("mousemove",y),document.addEventListener("mouseup",C)},c=()=>{s.value&&a.value&&s.value.removeEventListener("mousedown",i)};e((()=>{t((()=>{l.value?s.value&&a.value&&s.value.addEventListener("mousedown",i):c()}))})),n((()=>{c()}))},oe="_trap-focus-children",ae=[],se=e=>{if(0===ae.length)return;const t=ae[ae.length-1][oe];if(t.length>0&&e.code===r.tab){if(1===t.length)return e.preventDefault(),void(document.activeElement!==t[0]&&t[0].focus());const n=e.shiftKey,o=e.target===t[0],a=e.target===t[t.length-1];o&&n&&(e.preventDefault(),t[t.length-1].focus()),a&&!n&&(e.preventDefault(),t[0].focus())}},le=i({name:"ElMessageBox",directives:{TrapFocus:{beforeMount(e){e[oe]=J(e),ae.push(e),ae.length<=1&&document.addEventListener("keydown",se)},updated(e){l((()=>{e[oe]=J(e)}))},unmounted(){ae.shift(),0===ae.length&&document.removeEventListener("keydown",se)}}},components:{ElButton:U,ElFocusTrap:G,ElInput:F,ElOverlay:Q,ElIcon:c,...u},inheritAttrs:!1,props:{buttonSize:{type:String,validator:ee},modal:{type:Boolean,default:!0},lockScroll:{type:Boolean,default:!0},showClose:{type:Boolean,default:!0},closeOnClickModal:{type:Boolean,default:!0},closeOnPressEscape:{type:Boolean,default:!0},closeOnHashChange:{type:Boolean,default:!0},center:Boolean,draggable:Boolean,roundButton:{default:!1,type:Boolean},container:{type:String,default:"body"},boxType:{type:String,default:""}},emits:["vanish","action"],setup(t,{emit:o}){const{locale:r,zIndex:i,ns:c,size:u}=d("message-box",p((()=>t.buttonSize))),{t:h}=r,{nextZIndex:b}=i,y=m(!1),C=f({autofocus:!0,beforeClose:null,callback:null,cancelButtonText:"",cancelButtonClass:"",confirmButtonText:"",confirmButtonClass:"",customClass:"",customStyle:{},dangerouslyUseHTMLString:!1,distinguishCancelAndClose:!1,icon:"",inputPattern:null,inputPlaceholder:"",inputType:"text",inputValue:null,inputValidator:null,inputErrorMessage:"",message:null,modalFade:!0,modalClass:"",showCancelButton:!1,showConfirmButton:!0,type:"",title:void 0,showInput:!1,action:"",confirmButtonLoading:!1,cancelButtonLoading:!1,confirmButtonDisabled:!1,editorErrorMessage:"",validateError:!1,zIndex:b()}),E=p((()=>{const e=C.type;return{[c.bm("icon",e)]:e&&v[e]}})),x=te(),w=te(),B=p((()=>C.icon||v[C.type]||"")),M=p((()=>!!C.message)),k=m(),T=m(),I=m(),L=m(),R=m(),S=p((()=>C.confirmButtonClass));a((()=>C.inputValue),(async e=>{await l(),"prompt"===t.boxType&&null!==e&&j()}),{immediate:!0}),a((()=>y.value),(e=>{var n,o;e&&("prompt"!==t.boxType&&(C.autofocus?I.value=null!=(o=null==(n=R.value)?void 0:n.$el)?o:k.value:I.value=k.value),C.zIndex=b()),"prompt"===t.boxType&&(e?l().then((()=>{var e;L.value&&L.value.$el&&(C.autofocus?I.value=null!=(e=O())?e:k.value:I.value=k.value)})):(C.editorErrorMessage="",C.validateError=!1))}));const A=p((()=>t.draggable));function _(){y.value&&(y.value=!1,l((()=>{C.action&&o("action",C.action)})))}ne(k,T,A),e((async()=>{await l(),t.closeOnHashChange&&window.addEventListener("hashchange",_)})),n((()=>{t.closeOnHashChange&&window.removeEventListener("hashchange",_)}));const z=()=>{t.closeOnClickModal&&P(C.distinguishCancelAndClose?"close":"cancel")},$=Z(z),P=e=>{var n;("prompt"!==t.boxType||"confirm"!==e||j())&&(C.action=e,C.beforeClose?null==(n=C.beforeClose)||n.call(C,e,C,_):_())},j=()=>{if("prompt"===t.boxType){const e=C.inputPattern;if(e&&!e.test(C.inputValue||""))return C.editorErrorMessage=C.inputErrorMessage||h("el.messagebox.error"),C.validateError=!0,!1;const t=C.inputValidator;if("function"==typeof t){const e=t(C.inputValue);if(!1===e)return C.editorErrorMessage=C.inputErrorMessage||h("el.messagebox.error"),C.validateError=!0,!1;if("string"==typeof e)return C.editorErrorMessage=e,C.validateError=!0,!1}}return C.editorErrorMessage="",C.validateError=!1,!0},O=()=>{const e=L.value.$refs;return e.input||e.textarea},V=()=>{P("close")};return t.lockScroll&&W(y),((e,t)=>{let n;a((()=>e.value),(e=>{var o,a;e?(n=document.activeElement,s(t)&&(null==(a=(o=t.value).focus)||a.call(o))):n.focus()}))})(y),{...g(C),ns:c,overlayEvent:$,visible:y,hasMessage:M,typeClass:E,contentId:x,inputId:w,btnSize:u,iconComponent:B,confirmButtonClasses:S,rootRef:k,focusStartRef:I,headerRef:T,inputRef:L,confirmRef:R,doClose:_,handleClose:V,onCloseRequested:()=>{t.closeOnPressEscape&&V()},handleWrapperClick:z,handleInputEnter:e=>{if("textarea"!==C.inputType)return e.preventDefault(),P("confirm")},handleAction:P,t:h}}}),re=["aria-label","aria-describedby"],ie=["aria-label"],ce=["id"];var ue=h(le,[["render",function(e,t,n,o,a,s){const l=b("el-icon"),r=b("close"),i=b("el-input"),c=b("el-button"),u=b("el-focus-trap"),d=b("el-overlay");return y(),C(P,{name:"fade-in-linear",onAfterLeave:t[11]||(t[11]=t=>e.$emit("vanish")),persisted:""},{default:E((()=>[x(w(d,{"z-index":e.zIndex,"overlay-class":[e.ns.is("message-box"),e.modalClass],mask:e.modal},{default:E((()=>[B("div",{role:"dialog","aria-label":e.title,"aria-modal":"true","aria-describedby":e.showInput?void 0:e.contentId,class:M(`${e.ns.namespace.value}-overlay-message-box`),onClick:t[8]||(t[8]=(...t)=>e.overlayEvent.onClick&&e.overlayEvent.onClick(...t)),onMousedown:t[9]||(t[9]=(...t)=>e.overlayEvent.onMousedown&&e.overlayEvent.onMousedown(...t)),onMouseup:t[10]||(t[10]=(...t)=>e.overlayEvent.onMouseup&&e.overlayEvent.onMouseup(...t))},[w(u,{loop:"",trapped:e.visible,"focus-trap-el":e.rootRef,"focus-start-el":e.focusStartRef,onReleaseRequested:e.onCloseRequested},{default:E((()=>[B("div",{ref:"rootRef",class:M([e.ns.b(),e.customClass,e.ns.is("draggable",e.draggable),{[e.ns.m("center")]:e.center}]),style:k(e.customStyle),tabindex:"-1",onClick:t[7]||(t[7]=T((()=>{}),["stop"]))},[null!==e.title&&void 0!==e.title?(y(),I("div",{key:0,ref:"headerRef",class:M(e.ns.e("header"))},[B("div",{class:M(e.ns.e("title"))},[e.iconComponent&&e.center?(y(),C(l,{key:0,class:M([e.ns.e("status"),e.typeClass])},{default:E((()=>[(y(),C(L(e.iconComponent)))])),_:1},8,["class"])):R("v-if",!0),B("span",null,S(e.title),1)],2),e.showClose?(y(),I("button",{key:0,type:"button",class:M(e.ns.e("headerbtn")),"aria-label":e.t("el.messagebox.close"),onClick:t[0]||(t[0]=t=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),onKeydown:t[1]||(t[1]=A(T((t=>e.handleAction(e.distinguishCancelAndClose?"close":"cancel")),["prevent"]),["enter"]))},[w(l,{class:M(e.ns.e("close"))},{default:E((()=>[w(r)])),_:1},8,["class"])],42,ie)):R("v-if",!0)],2)):R("v-if",!0),B("div",{id:e.contentId,class:M(e.ns.e("content"))},[B("div",{class:M(e.ns.e("container"))},[e.iconComponent&&!e.center&&e.hasMessage?(y(),C(l,{key:0,class:M([e.ns.e("status"),e.typeClass])},{default:E((()=>[(y(),C(L(e.iconComponent)))])),_:1},8,["class"])):R("v-if",!0),e.hasMessage?(y(),I("div",{key:1,class:M(e.ns.e("message"))},[_(e.$slots,"default",{},(()=>[e.dangerouslyUseHTMLString?(y(),C(L(e.showInput?"label":"p"),{key:1,for:e.showInput?e.inputId:void 0,innerHTML:e.message},null,8,["for","innerHTML"])):(y(),C(L(e.showInput?"label":"p"),{key:0,for:e.showInput?e.inputId:void 0},{default:E((()=>[z(S(e.dangerouslyUseHTMLString?"":e.message),1)])),_:1},8,["for"]))]))],2)):R("v-if",!0)],2),x(B("div",{class:M(e.ns.e("input"))},[w(i,{id:e.inputId,ref:"inputRef",modelValue:e.inputValue,"onUpdate:modelValue":t[2]||(t[2]=t=>e.inputValue=t),type:e.inputType,placeholder:e.inputPlaceholder,"aria-invalid":e.validateError,class:M({invalid:e.validateError}),onKeydown:A(e.handleInputEnter,["enter"])},null,8,["id","modelValue","type","placeholder","aria-invalid","class","onKeydown"]),B("div",{class:M(e.ns.e("errormsg")),style:k({visibility:e.editorErrorMessage?"visible":"hidden"})},S(e.editorErrorMessage),7)],2),[[$,e.showInput]])],10,ce),B("div",{class:M(e.ns.e("btns"))},[e.showCancelButton?(y(),C(c,{key:0,loading:e.cancelButtonLoading,class:M([e.cancelButtonClass]),round:e.roundButton,size:e.btnSize,onClick:t[3]||(t[3]=t=>e.handleAction("cancel")),onKeydown:t[4]||(t[4]=A(T((t=>e.handleAction("cancel")),["prevent"]),["enter"]))},{default:E((()=>[z(S(e.cancelButtonText||e.t("el.messagebox.cancel")),1)])),_:1},8,["loading","class","round","size"])):R("v-if",!0),x(w(c,{ref:"confirmRef",type:"primary",loading:e.confirmButtonLoading,class:M([e.confirmButtonClasses]),round:e.roundButton,disabled:e.confirmButtonDisabled,size:e.btnSize,onClick:t[5]||(t[5]=t=>e.handleAction("confirm")),onKeydown:t[6]||(t[6]=A(T((t=>e.handleAction("confirm")),["prevent"]),["enter"]))},{default:E((()=>[z(S(e.confirmButtonText||e.t("el.messagebox.confirm")),1)])),_:1},8,["loading","class","round","disabled","size"]),[[$,e.showConfirmButton]])],2)],6)])),_:3},8,["trapped","focus-trap-el","focus-start-el","onReleaseRequested"])],42,re)])),_:3},8,["z-index","overlay-class","mask"]),[[$,e.visible]])])),_:3})}],["__file","/home/runner/work/element-plus/element-plus/packages/components/message-box/src/index.vue"]]);const de=new Map,pe=(e,t,n=null)=>{const o=w(ue,e,X(e.message)||V(e.message)?{default:X(e.message)?e.message:()=>e.message}:null);return o.appContext=n,H(o,t),(e=>{let t=document.body;return e.appendTo&&(O(e.appendTo)&&(t=document.querySelector(e.appendTo)),Y(e.appendTo)&&(t=e.appendTo),Y(t)||(t=document.body)),t})(e).appendChild(t.firstElementChild),o.component},me=(e,t)=>{const n=document.createElement("div");e.onVanish=()=>{H(null,n),de.delete(a)},e.onAction=t=>{const n=de.get(a);let s;s=e.showInput?{value:a.inputValue,action:t}:t,e.callback?e.callback(s,o.proxy):"cancel"===t||"close"===t?e.distinguishCancelAndClose&&"cancel"!==t?n.reject("close"):n.reject("cancel"):n.resolve(s)};const o=pe(e,n,t),a=o.proxy;for(const s in e)D(e,s)&&!D(a.$props,s)&&(a[s]=e[s]);return a.visible=!0,a};function fe(e,t=null){if(!j)return Promise.reject();let n;return O(e)||V(e)?e={message:e}:n=e.callback,new Promise(((o,a)=>{const s=me(e,null!=t?t:fe._context);de.set(s,{options:e,callback:n,resolve:o,reject:a})}))}const ve={alert:{closeOnPressEscape:!1,closeOnClickModal:!1},confirm:{showCancelButton:!0},prompt:{showCancelButton:!0,showInput:!0}};["alert","confirm","prompt"].forEach((e=>{fe[e]=function(e){return(t,n,o,a)=>{let s="";return K(n)?(o=n,s=""):s=q(n)?"":n,fe(Object.assign({title:s,message:t,type:"",...ve[e]},o,{boxType:e}),a)}}(e)})),fe.close=()=>{de.forEach(((e,t)=>{t.doClose()})),de.clear()},fe._context=null;const ge=fe;ge.install=e=>{ge._context=e._context,e.config.globalProperties.$msgbox=ge,e.config.globalProperties.$messageBox=ge,e.config.globalProperties.$alert=ge.alert,e.config.globalProperties.$confirm=ge.confirm,e.config.globalProperties.$prompt=ge.prompt};const he=ge;function be(e){return N({url:"table",method:"post",data:e})}function ye(e){return N({url:`table/${e}`,method:"delete"})}function Ce(e){return N({url:"table",method:"put",data:e})}function Ee(e){return N({url:"table",method:"get",params:e})}export{he as E,Ce as a,be as c,ye as d,Ee as g,ne as u};
